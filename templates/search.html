{% extends "base.html" %}

{% block header %}
  Search
{% endblock %}

{% block content %}
  <section class="search-section">
    <form method="POST" class="form">
      <input 
        class="field"
        type="text" 
        name="query" 
        placeholder="Search arena" 
        value="{{ query }}"
      />
      
      <div class="search-filters">
        <input 
          class="field"
          type="number" 
          name="min_time" 
          placeholder="Min time (minutes)"
          value="{{ min_time }}"
        />
        <input 
          class="field"
          type="number" 
          name="max_time" 
          placeholder="Max time (minutes)"
          value="{{ max_time }}"
        />
        <input 
          class="field"
          type="text" 
          name="include_ingredients" 
          placeholder="Ingredients to include"
          value="{{ include_ingredients }}"
        />
        <input 
          class="field"
          type="text" 
          name="exclude_ingredients" 
          placeholder="Ingredients to exclude"
          value="{{ exclude_ingredients }}"
        />
      </div>

      <button type="submit" class="btn">Search</button>
    </form>
  </section>

  <section class="search-results">
    {% if results %}
      <h2 class="section-title">Search Results</h2>
      <ul class="recipe-cards">
      {% for recipe in results %}
        <li class="recipe-card">
          <h3>{{ recipe.name }}</h3>
          <div class="recipe-card-info">
            {% if recipe.ingredients %}
              <span><strong>Ingredients:</strong> {{ recipe.ingredients[:4]|join(', ') }}{% if recipe.ingredients|length > 4 %}...{% endif %}</span>
            {% endif %}
            {% if recipe.prep_time %}
              <span><strong>Time to Cook:</strong> {{ recipe.prep_time }} minutes</span>
            {% endif %}
            {% if recipe.rating %}
              <span><strong>Rating:</strong> {{ recipe.rating }} Stars</span>
            {% endif %}
          </div>
          <div class="recipe-actions">
            <a href="{{ url_for('view_recipe', recipe_id=recipe._id) }}" class="button-background">
              <span class="button-text">View Dish</span>
            </a>
          </div>
        </li>
      {% endfor %}
      </ul>
    {% elif query %}
      <div class="no-results">
        <p>No recipes found for "{{ query }}"</p>
      </div>
    {% endif %}
  </section>
{% endblock %}
